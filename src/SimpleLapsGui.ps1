<#
Name: SimpleLapsGui.ps1
Version: 2.2
Developer: htcfreek (Heiko Horwedel) - https://gtihub.com/htcfreek
Date: 2026-02-18
Description: Gui script for Windows LAPS in AD environments.
License: MIT License
GitHub Repository: https://github.com/htcfreek/SimpleLapsGui
Requirements: Windows LAPS cmdlet;
			  Powershell 5.1;
			  (Optional: Legacy LAPS cmdlet to chenge the expiration time for Legacy LAPS passwords.)

NOTES:
- Known issue: The taskbar shows the powershell icon. (GitHub#1)

VERSION HISTORY:
2023-04-22 / v1.0 / htcfreek / Initial release
2023-04-25 / v1.1 / htcfreek / Don't use PS2Exe anymore because of to many virus arlerts.; Small code improvements.
2023-07-16 / v1.2 / htcfreek / Fix crash in password history. [Thanks @F1reF0x (github.com/F1reF0x).]; Auto hide PS window. [Thanks @F1reF0x (github.com/F1reF0x).]; Small code improvements.; Add update link to GUI.
2025-12-19 / v2.0 / htcfreek / Main UI redisign; Multi domain support; Zoom dialog for bigger crdential preview; Set time dialog now respects system's format settings.; Fixed bug with wrong error message after setting the time.; Support for ESCAPE key in time dialog and about dialog.; Fixed dpi scaling bug in about dialog.; Improved window size on different dpi scalings.; Various improvements.; Replaced AutoIT wrapper executable with a Batch file.
2026-02-17 / v2.1 / htcfreek / Development version towards version 2.2
2026-02-18 / v2.2 / htcfreek / Code improvements; Improvements for screen readers; Improvements on error handling; Added indicators for long running tasks; Improvements on the code that validates the time set result.; Fixed "window not responding" crashes by moving LDAP requests into background jobs.; Fix the bug that on long error detail messages the tooltip exceeds the monitor wide.

#>

$scriptVersion = "2.2"
$windowTitle = "Simple LAPS GUI"
# set-clipboard ([Convert]::ToBase64String((Get-Content ".\copyIcon.ico" -Encoding Byte)))
# All the images were created by me. They are not copied from the internet.
$windowIcon = "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"
$magnifyIcon = "AAABAAEAGBkAAAEAIADsCQAAFgAAACgAAAAYAAAAMgAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8AAAAABgAAABr///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wAAAAA8AAAAJgAAAIT///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAD0AAAD+AAAA/wAAAIX///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wAAAAAQAAAAPAAAAP4AAAD/AAAA/wAAAIT///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAYAAAB7AAAA/gAAAP8AAAD/AAAA/wAAABr///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8AAAAAJgAAAEoAAADzAAAA/wAAAP8AAAD+AAAAEP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAABAAAAA4AAAA+wAAAP4AAAD/AAAA/wAAAK4AAABH////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wAAAAAQAAAAIQAAAHEAAAD+AAAA/wAAAP8AAAD/AAAAqQAAABoAAAAG////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAB0AAABpAAAA+gAAAP4AAAD/AAAA/wAAAP4AAACFAAAAJP///wD///8A////AP///wD///8A////AP///wD///8A/6gALP+yAGP/uwCe/8UAyv+7AJ7/sgBj/6gALAAAAIsAAAD+AAAA/wAAAP8AAAD/AAAA/AAAADgAAAAQ////AP///wD///8A////AP///wD///8A////AP+mABf/rwBg/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDK/8UAyv7EAMrPoADUa1IA7AAAAP8AAAD+AAAANf///wD///8A////AP///wD///8A////AP///wD///8A/6EAE/+yAG3/xQDK/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDKx5oA1gAAAHEAAAA0AAAABv///wD///8A////AP///wD///8A////AP///wD///8A/68AWf/FAMr/xQDK/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDK+8EAxgAAABD///8A////AP///wD///8A////AP///wD///8A////AP///wD/ogAh/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDKAAAA/wAAAP//xQDK/8UAyv/FAMr/xQDK/8UAyv+iACH///8A////AP///wD///8A////AP///wD///8A////AP///wD/rQBU/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDKAAAA/wAAAP//xQDK/8UAyv/FAMr/xQDK/8UAyv+tAFT///8A////AP///wD///8A////AP///wD///8A////AP///wD/uQCK/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDKAAAA/wAAAP//xQDK/8UAyv/FAMr/xQDK/8UAyv+5AIr///8A////AP///wD///8A////AP///wD///8A////AP///wD/xQDK/8UAyv/FAMr/xQDKAAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//xQDK/8UAyv/FAMr///8A////AP///wD///8A////AP///wD///8A////AP///wD/xQDK/8UAyv/FAMr/xQDKAAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP//xQDK/8UAyv/FAMr///8A////AP///wD///8A////AP///wD///8A////AP///wD/uQCK/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDKAAAA/wAAAP//xQDK/8UAyv/FAMr/xQDK/8UAyv+5AIr///8A////AP///wD///8A////AP///wD///8A////AP///wD/rQBU/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDKAAAA/wAAAP//xQDK/8UAyv/FAMr/xQDK/8UAyv+tAFT///8A////AP///wD///8A////AP///wD///8A////AP///wD/ogAh/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDKAAAA/wAAAP//xQDK/8UAyv/FAMr/xQDK/8UAyv+iACH///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A/68AWf/FAMr/xQDK/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDK/68AWf///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A/6EAE/+yAG3/xQDK/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDK/8UAyv/FAMr/sgBt/6EAE////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP+mABf/rwBg/8UAyv/FAMr/xQDK/8UAyv/FAMr/xQDK/8UAyv+vAGD/pgAX////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A/6gALP+yAGP/uwCe/8UAyv+7AJ7/sgBj/6gALP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///wA///4AP//8AD//8AA//+AAP//AQD//AMA//ADAP/gDwDwAB8AwAB/AIAAfwCAAf8AAAH/AAAB/wAAAf8AAAH/AAAB/wAAAf8AAAH/AAAB/wCAA/8AgAP/AMAH/wDwH/8A"
$copyUserIcon = "AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/9fW+P/X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/19bk/9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1uQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/X1sT/19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fWxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/9fWl//X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//2NaXAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/19Ze/9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9fW///X1v//19b//9jW///Y1v//2Nb//9jW///Y1l4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/X1hn/19b+/9fW///X1v//19b//9fW///X1v//19b//9fW///Y1v//2Nb//9jW///Y1v//2Nb//9jW///Y1v//2Nb+/9jWGQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/X1qr/19b//9fW///X1v//2Nb//9jW///Y1v//2Nb//9jW///Y1v//2Nb//9jW///Y1v//2Nb//9jW///Y16oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/9jWS//Y1v//2Nb//9jW///Y1v//2Nb//9jW///Y1v//2Nb//9jW///Y1v//2Nb//9jX///Y1///2Nf//9jXSwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/9jWpv/Y1v//2Nb//9jW///Y1v//2Nb//9jW///Y1v//2Nf//9jX//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA/wAAAAAAAAAAAAAAAAAAAAD/2NYy/9jW1v/Y1v//2Nb//9jW///Y1///2Nf//9jX///Y1///2Nf//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/AAAAAAAAAAAAAAAAAAAAAAAAAAD/2NZY/9jX3f/Y1//z7/n/3P3//77///++////3P3///Pv+f//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/2NdR5/f/56bv//+m7///pu///6bv//+m7///pu////8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKbv///G//+Bpu///6bv//+m7///pu///6bv//+m7////wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApu///6bv//+m7///pu///6bv//+m7///pu///6bv////AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACm7///pu///6bv//+m7///pu///6bv//+m7///pu////8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKbv//+m7///pu///6fv//+n7///p+///6fv//+n7////wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAp+///6fv//+n7///p+///6fv//+n7///p+///6fv////AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACn7///p+///6fv//+n7///p+///6fv//+n7///p+///6fv////AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACn7///p+///6fv//+n7///p+///6fv//+n7///p+////8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACn7///p+///6fv//+n7///p+///6fv//8AAAAAAAAAAP8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAA//8AAP//AAD/tz6N/wCc5v8AvP//ALz//wCc5v+3Po3//wAA//8AAP//AAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/wAA/2mByOcAwf//AMH//wDB//8Awf//AMH//wDB//9pgcjn/wAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwf//ALb/gQDB//8Awf//AMH//wDB//8Awf//AMH//wC2/4EAwf//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADB//8Awf//AMH//wDB//8Awf//AMH//wDB//8Awf//AMH//wDB//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMH//wDB//8Awf//AMH//wDB//8Awf//AMH//wDB//8Awf//AMH//wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwf//AMH//wDB//8Awf//AMH//wDB//8Awf//AMH//wDB//8Awf//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADB//8Awf//AMH//wDB//8Awf//AMH//wDB//8Awf//AMH//wDB//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMH//wDB//8Awf//AMH//wDB//8Awf//AMH//wDB//8Awf//AMH//wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMH//wDB//8Awf//AMH//wDB//8Awf//AMH//wDB//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMH//wDB//8Awf//AMH//wDB//8Awf//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAf/4AAH/+AAB//gAAf/4AAH/+AAB//wAA//8AAP//gAAAB4AAAAfAAAAH4AAAB+AAAAfgAAAH4AAAB+AAAAfgAAAH4AAAD/AAAA/4GAAf//gAH//8AD///gB///4Af//+AH///gB///4Af//+AH///gB///8A////gf/////8="
$copyPasswordIcon = "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AACAbFwAgGxcAIBtXACBbVwAgW1cAIJtXACzz93kf/j//4D4//+A+P//gfj//4H4//+B+P//gvj//4L5//9+x9v/AK/v/wCW0f8Ase//AMz//wBEa7cAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIBsXACAbVwAgW1cAIFtXACCbVwAx7y0PVTw//+A+P//gPj//4D4//+B+P//gfj//4L4//+C+P//gvn//4P5//88ka//AMj//wBnk/8Ay///AK3r/wAAAGynlokzg2pVHwAAAAAAAAAAAAAAAAAAAAAAAAAAgGxcAIFtXACBbVwAgm1cAIJtXQDFubFcaPT//4D4//+A+P//gfj//4H4//+C+P//gvj//4L5//+D+f//g/n//3Da9f8AjsH+ALz+/wCPyv8Ay///AJ7Y/wCq4f8AhsH/HoSu4AAAAHoAAAAKAAAAAAAAAACBbVwAgW1cAIJtXACCbV0Agm5dALuvplab6P//gPj//4H4//+B+P//gvj//4L4//+C+f//g/n//4P5//+E+f//hPn//16DkesAuvf/AK7t/wDL//8Ay///AMv//wDM//8AzP//AML//wBgiOJiNwArAAAAAIFtXACBbVwAgm1dAIJuXQCDbl0A3dPMKKrc8f+B+P//gfj//4H4//+C+P//gvn//7Lp//+Z2vH/u+b6/4T5//+E+f//aKjCuzmx5P8Ay///AMv//wDL//8Ay///AMz//wDM//8AzP//AM///x9aeeeQemcVgW1dAIJtXQCCbl0Ag25dAINuXQCDbl0Ajcfisn74//+B+P//gvj//4L5//+D+f//e9///4z5//+X2/T/qPL//7nq//8ZaInrAMv//wDL//8Ay///AMv//wDM//8AzP//AMz//wDM//8AzP//ALb2/wAAAGGCbV0Agm1dAINuXQCDbl0Ag25dAIRuXQDo39gnmdbw53/4//+C+f//g/n//4P5//+r1Ob/quP4/7Lb7f96+P//jKOwswCPzf8Ay///AMv//wDL//8AzP//AMz//wDM//8AzP//AMz//wDM//8AzP//AABPuIJtXQCCbl0Ag25dAINuXQCEbl0AhG9dAIRvXQCFb10ftc7ezZDq//+D+f//g/n//4T5//+o7P//reH2/5i+04hGAABcAKvs/wDL//8Ay///AMz//wDM//8AzP//AMz//wDM//8AzP//AMz//wDN//8AaqDcgm5dAINuXQCDbl0AhG5dAIRvXQCEb10AhW9dAIVvXQCGcF0Ayr21ZtDU2K+92+rMtsnVy6Kvu4/m29QgiHFeACEAAFYAquj/AMv//wDL//8AzP//AMz//wDM//8AzP//AMz//wDM//8AzP//AM3//wBmkdcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAinRhKACJvf8Ay///AMz//wDM//8AzP//AMz//wCq4f8Adqb/HqTV/wDN//8Azf//AAAdkgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAChcsgDJ//8AzP//AMz//wDM//8AzP//AHSp/wDP//8AfK7/AMH//xCv5f9EAABGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACjkoQnAG+j5wDJ//8AzP//AMz//wDM//8Ab5n/AJ7T/wCKuf8Avf//ADVamwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfB2KGzQCo5/8AzP//AMz//wDM//8Asu//AJfM/wAAHYgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVhcAZmp4hq8jibPMJFJrywAAAI+einogAAAAAAAAAAAAAAAAD///+Af///gH///4B///+AH///iB4f/4geD/+MDg//jgYP/44CA/+PAwP/j4AD/4+AAf+PwAD/j8AAf4/AAH+PgAAPj4AAAY+AAACPgAAAD8AAAA/AAAAP4AAAD/gQAA//8AAP//gAD//4AI///AGP//8Dg="
$progressRunningGif = "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"


# ------------- Show user info in PS window -------------
Write-Host "Starting application and loading graphical user interface ..."
# ------------- Show user info in PS window -------------

# ------------- Load WinForms Assembly --------------------
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Drawing")
[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms")
[void] [Windows.Forms.Application]::EnableVisualStyles()
# ------------- Load WinForms Assembly --------------------

# ------------- Make process DPI aware --------------------
Add-Type -TypeDefinition @'
using System;
using System.Runtime.InteropServices;
public class ProcessDPI {
    [DllImport("user32.dll", SetLastError=true)]
    public static extern bool SetProcessDPIAware();
    
    [DllImport("user32.dll", SetLastError=true)]
    public static extern uint GetDpiForWindow(IntPtr hWnd); 
}
'@
$null = [ProcessDPI]::SetProcessDpiAware()

<#Add-Type -TypeDefinition @'
using System;
using System.Runtime.InteropServices;
public class ProcessDPIAwareness {
    [DllImport("user32.dll", SetLastError=true)]
    public static extern bool SetProcessDpiAwarenessContext(int context);   
    
    public class DpiAwarenessContext {
        public static readonly IntPtr UNAWARE              = (IntPtr) (-1);
        public static readonly IntPtr SYSTEM_AWARE         = (IntPtr) (-2);
        public static readonly IntPtr PER_MONITOR_AWARE    = (IntPtr) (-3);
        public static readonly IntPtr PER_MONITOR_AWARE_V2 = (IntPtr) (-4);
        public static readonly IntPtr UNAWARE_GDISCALED    = (IntPtr) (-5);
    }
}
'@#>
# ------------ Make process DPI aware --------------------

# ------------ Check for available LAPS cmdlets ----
if (-Not (Get-Module -Name Laps -ListAvailable))
{
    [System.Windows.Forms.MessageBox]::Show("Windows LAPS PowerShell module not found!!", $windowTitle + " - ERROR", "OK", "Error");
    exit 501
}
$Script:IsLegacyLapsInstalled = [bool](Get-Module -Name "AdmPwd.PS" -ListAvailable)
# ------------ Check for available LAPS cmdlets ----

# ------------ Check for correct PS-Version --------------
if (-Not $PSVersionTable.PSVersion.ToString().StartsWith("5.1"))
{
    [System.Windows.Forms.MessageBox]::Show("Windows PowerShell version 5.1 required!!", $windowTitle + " - ERROR", "OK", "Error");
    exit 501
}
# ------------ Check for correct PS-Version --------------

# ------------- Create icon images ---------------------
$windowIconBytes = [Convert]::FromBase64String($windowIcon)
$windowIconStream = [System.IO.MemoryStream]::new($windowIconBytes, 0, $windowIconBytes.Length)
$windowIconImage = [System.Drawing.Icon]::FromHandle(([System.Drawing.Bitmap]::new($windowIconStream).GetHIcon()))
#---
$magnifyIconBytes = [Convert]::FromBase64String($magnifyIcon)
$magnifyIconStream = [System.IO.MemoryStream]::new($magnifyIconBytes, 0, $magnifyIconBytes.Length)
$magnifyIconImage = [System.Drawing.Image]::FromStream($magnifyIconStream)
#---
$copyUserIconBytes = [Convert]::FromBase64String($copyUserIcon)
$copyUserIconStream = [System.IO.MemoryStream]::new($copyUserIconBytes, 0, $copyUserIconBytes.Length)
$copyUserIconImage = [System.Drawing.Image]::FromStream($copyUserIconStream)
#---
$copyPasswordIconBytes = [Convert]::FromBase64String($copyPasswordIcon)
$copyPasswordIconStream = [System.IO.MemoryStream]::new($copyPasswordIconBytes, 0, $copyPasswordIconBytes.Length)
$copyPasswordIconImage = [System.Drawing.Image]::FromStream($copyPasswordIconStream)
#---
$progressRunningGifBytes = [Convert]::FromBase64String($progressRunningGif)
$progressRunningGifStream = [System.IO.MemoryStream]::new($progressRunningGifBytes, 0, $progressRunningGifBytes.Length)
$progressRunningGifImage = [System.Drawing.Image]::FromStream($progressRunningGifStream)
# ------------- Create window icon image ---------------------


#### Method to hide PS window
############################################################################
function Show-Console
{
    # .Net methods for hiding/showing the console in the background
    # Usage: show-console -show / show-console -hide
    # Originally authored by @F1reF0x (github.com/F1reF0x)

    param ([Switch]$Show,[Switch]$Hide)

    if (-not ("Console.Window" -as [type])) {
        Add-Type -Name Window -Namespace Console -MemberDefinition '
        [DllImport("Kernel32.dll")]
        public static extern IntPtr GetConsoleWindow();

        [DllImport("user32.dll")]
        public static extern bool ShowWindow(IntPtr hWnd, Int32 nCmdShow);
        '
    }

    if ($Show)
    {
        $consolePtr = [Console.Window]::GetConsoleWindow()
        # Hide = 0, ShowNormal = 1, ShowMinimized = 2, ShowMaximized = 3, Maximize = 3, ShowNormalNoActivate = 4,
        # Show = 5, Minimize = 6, ShowMinNoActivate = 7, ShowNoActivate = 8, Restore = 9, ShowDefault = 10, ForceMinimized = 11
        $null = [Console.Window]::ShowWindow($consolePtr, 5)
    }

    if ($Hide)
    {
        $consolePtr = [Console.Window]::GetConsoleWindow()
        #0 hide
        $null = [Console.Window]::ShowWindow($consolePtr, 0)
    }
}


### Implement multithreading
### - For more details see the script part "Password & Time set methods"
############################################################################
[void] [System.Reflection.Assembly]::LoadWithPartialName("Management.Automation.Runspaces")

$ThreadSyncHash = [hashtable]::Synchronized(@{
    # The first four properties contain special information that we need in all background jobs.
    SearchComputerInput_Text = ""
    DomainComputer_Identity = ""
    DomainComputer_Domain= $null
    DomainComputer_HasWinLaps = $false
    ThreadCommand_State = 'None' # None, HandleResult, Running, CompletedSearch, CompletedTimeSet
	ThreadCommand_Result = '' # Success, Aborted, Failed
	ThreadCommand_Data = $null
})

$Script:RunspaceInstanceCache = @{
    PsInstance = $null
    PsInvokationHandle = $null
}

# Never use: $runSpace.ApartmentState = 'STA', $runSpace.ThreadOptions = 'ReuseThread'
$runSpace = [runspacefactory]::CreateRunspace([initialsessionstate]::CreateDefault2())
$runSpace.Open()
$runSpace.SessionStateProxy.SetVariable('ThreadSyncHash', $ThreadSyncHash)
$psThreadInstance = [powershell]::Create()
$psThreadInstance.Runspace = $runSpace

# WinForms timer to handle results
$script:BgJobTimer = New-Object System.Windows.Forms.Timer
$script:BgJobTimer.Interval = 1  # milliseconds
$script:BgJobTimer.Add_Tick({
    if ($ThreadSyncHash.ThreadCommand_State -like 'Completed*') {
        # update state
        $lastThreadCommandState = $ThreadSyncHash.ThreadCommand_State.Clone()
        $lastThreadCommandResult = $ThreadSyncHash.ThreadCommand_Result.Clone()
        $ThreadSyncHash.ThreadCommand_State = 'TimerHandleResult'
        $ThreadSyncHash.ThreadCommand_Result = ''

        # end ps bg instance
        try {
          $RunspaceInstanceCache.PsInstance.EndInvoke($RunspaceInstanceCache.PsInvokationHandle)
        }
        catch {}

        # Update GUI and data
        if ($lastThreadCommandState -eq 'CompletedSearch') {
            Update-WindowAfterBgJob -Job SearchPassword -JobResult $lastThreadCommandResult

            # finally cleanup variables and stop timer
            $ThreadSyncHash.ThreadCommand_Data = $null
		    $ThreadSyncHash.ThreadCommand_State = 'None'
            $Script:BgJobTimer.Stop()
        }
        elseif (($lastThreadCommandState -eq 'CompletedTimeSet') -and ($lastThreadCommandResult -eq 'Failed')) {
            Update-WindowAfterBgJob -Job SetTime -JobResult $lastThreadCommandResult

            # finally cleanup variables and stop timer
            $ThreadSyncHash.ThreadCommand_Data = $null
		    $ThreadSyncHash.ThreadCommand_State = 'None'
            $Script:BgJobTimer.Stop()
        }    
        elseif (($lastThreadCommandState -eq 'CompletedTimeSet') -and ($lastThreadCommandResult -eq 'Success')) {
            Update-WindowAfterBgJob -Job SetTime -JobResult $lastThreadCommandResult

            # finally cleanup variables; keep timer alive
            $ThreadSyncHash.ThreadCommand_Data = $null
		    $ThreadSyncHash.ThreadCommand_State = 'None'

            # After changing the time sucessfully we need to read the data again
            Invoke-GetPasswordBtnCmd -UpdateAfterTimeSet
        }
    }
})



#### Password & Time set methods
############################################################################
# How search/get password and set time works:
# The button triggers a function that looks the window, starts a winforms timer and triggers a background job in a dedicated PS runspace.
# The triggered background job executes the job script which uses a synchronized hash for data exchange.
# While the job is executing the timer monitors the state of the background job and after the job finished it executes a window update command.
# Then the window update command updates the window based on the job results.

# Background job script for search/getting passwords
[scriptblock]$GetPasswordScript = {
    $ThreadSyncHash.ThreadCommand_State = 'Running'

    $jobResult = [PSCustomObject]@{
        Account = $null
        Password = $null
        ExpirationTime = $null
        PwdHistory = $null
        StatusMessage = ""
        StatusExplain = ""
    }

    # Get password
    try
    {
        if ([string]::IsNullOrWhiteSpace($ThreadSyncHash.DomainComputer_Domain)) {
           $pwds = Get-LapsADPassword -Identity "$($ThreadSyncHash.DomainComputer_Identity)" -AsPlainText -IncludeHistory -ErrorAction Stop -WarningAction SilentlyContinue | Select-Object ComputerName,Account,Password,PasswordUpdateTime,ExpirationTimestamp
        }
        else {
           $pwds = Get-LapsADPassword -Identity "$($ThreadSyncHash.DomainComputer_Identity)" -Domain "$($ThreadSyncHash.DomainComputer_Domain)" -AsPlainText -IncludeHistory -ErrorAction Stop -WarningAction SilentlyContinue | Select-Object ComputerName,Account,Password,PasswordUpdateTime,ExpirationTimestamp
        }
    }
    catch
    {
        if ($_.Exception.Message.Contains("computer in AD"))
        {
            $jobResult.StatusMessage = "Failed: Computer not found!"
            $ThreadSyncHash.ThreadCommand_Result = "Failed"
            $ThreadSyncHash.ThreadCommand_Data = $jobResult
            $ThreadSyncHash.ThreadCommand_State = "CompletedSearch"
            return
        }
        elseif ($_.Exception.Message.Contains("run on a AD domain-joined machine"))
        {
            $jobResult.StatusMessage = "Failed: This program must be run on an AD domain-joined machine!"
            $ThreadSyncHash.ThreadCommand_Result = "Failed"
            $ThreadSyncHash.ThreadCommand_Data = $jobResult
            $ThreadSyncHash.ThreadCommand_State = "CompletedSearch"
            return
        }
        else
        {
            $jobResult.StatusMessage = "Something failed! - Hover for more information."
            $jobResult.StatusExplain = "$($_.Exception.Message)"
            $ThreadSyncHash.ThreadCommand_Result = "Failed"
            $ThreadSyncHash.ThreadCommand_Data = $jobResult
            $ThreadSyncHash.ThreadCommand_State = "CompletedSearch"
            return
        }
    }
    if ($null -eq $pwds)
    {
        $jobResult.StatusMessage = "Success: No password(s) available or missing permission."
        $ThreadSyncHash.ThreadCommand_Result = "Success"
        $ThreadSyncHash.ThreadCommand_Data = $jobResult
        $ThreadSyncHash.ThreadCommand_State = "CompletedSearch"
        return
    }

    # Validate current password
    if ($null -eq $pwds[0])
    {
        $jobResult.StatusMessage = "Something failed! - Data set for current password is invalid."
        $ThreadSyncHash.ThreadCommand_Result = "Failed"
        $ThreadSyncHash.ThreadCommand_Data = $jobResult
        $ThreadSyncHash.ThreadCommand_State = "CompletedSearch"
        return
    }
    elseif ($null -eq $pwds[0].Password -or $null -eq $pwds[0].ComputerName -or $null -eq $pwds[0].ExpirationTimestamp)
    {
        $jobResult.StatusMessage = "Something failed! - Data set for current password is invalid."
        $ThreadSyncHash.ThreadCommand_Result = "Failed"
        $ThreadSyncHash.ThreadCommand_Data = $jobResult
        $ThreadSyncHash.ThreadCommand_State = "CompletedSearch"
        return
    }

    # create result data
    $compHasWinLaps = [bool]($null -ne $pwds[0].PasswordUpdateTime)
    if ($compHasWinLaps) {
        # winlaps with account
        $jobResult.Account = $pwds[0].Account.Clone()
        $jobResult.Password = $pwds[0].Password.Clone()
        $jobResult.ExpirationTime = $pwds[0].ExpirationTimestamp.ToString()
        $jobResult.PwdHistory = $pwds | select -Property PasswordUpdateTime,Account,Password -Skip 1
        $jobResult.StatusMessage = "Success."
    }
    else {
        # legacy laps without account
        $jobResult.Password = $pwds[0].Password.Clone()
        $jobResult.ExpirationTime = $pwds[0].ExpirationTimestamp.ToString()
        $jobResult.PwdHistory = $pwds | select -Property PasswordUpdateTime,Account,Password -Skip 1
        $jobResult.StatusMessage = "Success."
    }

    # return results
    $pwds = $null
    $ThreadSyncHash.DomainComputer_HasWinLaps = $compHasWinLaps
    $ThreadSyncHash.ThreadCommand_Data = $jobResult
    $ThreadSyncHash.ThreadCommand_Result = "Success"
    $ThreadSyncHash.ThreadCommand_State = "CompletedSearch"
    return
}

# Button command for search/getting passwords
# - Parameter [switch]$UpdateAfterTimeSet : If we update information after time set, we handle some things differently.
function Invoke-GetPasswordBtnCmd ([switch]$UpdateAfterTimeSet)
{
    # Clear current data from UI and set status
    $ThreadSyncHash.SearchComputerInput_Text = ""
    $ThreadSyncHash.DomainComputer_Identity = ""
    $ThreadSyncHash.DomainComputer_Domain = $null
    $ThreadSyncHash.DomainComputer_HasWinLaps = $false
    #---
    $compTextBox.Enabled = $false
    $GoButton.Enabled = $false
    if ($UpdateAfterTimeSet -eq $false) {
        $SearchRunningGif.Image = $progressRunningGifImage
        $SearchRunningGif.Show()
    }
    $AccountNameData.Text = " "
    $AccountNameCopyButton.Hide()
    $AccountNamePreviewButton.Hide()
    $PasswordData.Text = " "
    $PasswordCopyButton.Hide()
    $PasswordPreviewButton.Hide()
    $ExpirationTimeData.Text = " "
    $TimeSetButton.Hide()
    $TimeSetNotSupportedText.Hide()
	$TimeSetNoLegacyModuleText.Hide()
    [void]$ListPwdHistory.Items.Clear()
    $ListPwdHistory.Enabled = $false
    #---
    if ($UpdateAfterTimeSet -eq $false) {
        # search computer
        Set-StatusText -Text "Searching ..." -Color Black
    }
    else {
        # update info after time change
		Set-StatusText -Text "Getting updated LAPS properties ..." -Color Black
    }
    Start-Sleep -Milliseconds 250 # To show status correct.

    # Check computer name input
    [string]$inputComputerName = $compTextBox.Text
    if ([string]::IsNullOrWhiteSpace($inputComputerName))
    {
        Set-StatusText -Text "Failed: You must enter a computer name!" -Color Red
        $compTextBox.Enabled = $true
        $GoButton.Enabled = $true
        $SearchRunningGif.Image = $null
        $SearchRunningGif.Hide()
        $ListPwdHistory.Enabled = $true
        return
    }
    if ($inputComputerName -match "^CN=.*,.*DN=.*") {
        Set-StatusText -Text "Failed: Distinguished name (DN) is not supported!" -Color Red
        $compTextBox.Enabled = $true
        $GoButton.Enabled = $true
        $SearchRunningGif.Image = $null
        $SearchRunningGif.Hide()
        $ListPwdHistory.Enabled = $true
        return
    }

    # Update computer properties
    # -- domain can keep unchanged
    if ($inputComputerName -eq ".\") {
        # .\ (local host)
        $compTextBox.Text = $env:COMPUTERNAME
        $ThreadSyncHash.SearchComputerInput_Text = $env:COMPUTERNAME
        $ThreadSyncHash.DomainComputer_Identity = $env:COMPUTERNAME
        $ThreadSyncHash.DomainComputer_Domain = $null
    }
    elseif ($inputComputerName -match ".+\\.+") {
        # domain\computer
        $splitName = ($inputComputerName -split "\\")
        $ThreadSyncHash.SearchComputerInput_Text = $splitName[1]
        $ThreadSyncHash.DomainComputer_Identity = $splitName[1]
        $ThreadSyncHash.DomainComputer_Domain = $splitName[0]
    }
    elseif ($inputComputerName -match ".+\..+") {
        # xyz.domain.local (fqdn)
        $splitName = ($inputComputerName -split "\.",2)
        $ThreadSyncHash.SearchComputerInput_Text = $splitName[0]
        $ThreadSyncHash.DomainComputer_Identity = $inputComputerName
        $ThreadSyncHash.DomainComputer_Domain = $splitName[1]
    }
    else {
        # computer name only
        $ThreadSyncHash.SearchComputerInput_Text = $inputComputerName
        $ThreadSyncHash.DomainComputer_Identity = $inputComputerName
        $ThreadSyncHash.DomainComputer_Domain = $null
    }

    # execute domain query in sub thread        
    #############
    try {
        $RunspaceInstanceCache.PsInstance.EndInvoke($RunspaceInstanceCache.PsInvokationHandle)
    }
    catch { }
    if (-Not $UpdateAfterTimeSet) {
        # if we are after succes time set, we have a running timer from time change job
        $script:BgJobTimer.Start()
    }
    $psThreadInstance.Commands.Clear()
    $psThreadInstance.AddScript($GetPasswordScript)
    $Script:RunspaceInstanceCache.PsInstance = $psThreadInstance
    $Script:RunspaceInstanceCache.PsInvokationHandle = $psThreadInstance.BeginInvoke()
}

# Background job script for setting time
[scriptblock]$SetExpirationTimeScript = {
    $ThreadSyncHash.ThreadCommand_State = 'Running'
	$newExpTime = $ThreadSyncHash.ThreadCommand_Data.NewTime
    $jobResult = [PSCustomObject]@{
        StatusMessage = ""
        StatusExplain = ""
    }

    try {
        # Execute
        if ($ThreadSyncHash.DomainComputer_HasWinLaps) {
            # WinLaps
            if (![string]::IsNullOrWhiteSpace($ThreadSyncHash.DomainComputer_Domain)) {
                # custom domain
                Set-LapsADPasswordExpirationTime -Identity $ThreadSyncHash.DomainComputer_Identity -Domain $ThreadSyncHash.DomainComputer_Domain -WhenEffective $newExpTime -ErrorAction Stop -WarningAction SilentlyContinue
            }
            else {
                # defautl domain
                Set-LapsADPasswordExpirationTime -Identity $ThreadSyncHash.DomainComputer_Identity -WhenEffective $newExpTime -ErrorAction Stop -WarningAction SilentlyContinue
            }
        }
        else {
            # LegacyLaps
            Reset-AdmPwdPassword -ComputerName $ThreadSyncHash.SearchComputerInput_Text -WhenEffective $newExpTime -ErrorAction Stop -WarningAction SilentlyContinue
        }

        # get current time of ad object to verify time change
        # - Sleep 3 seconds before request that change command has enough time for execution
        # - Try 5 times in case the dc sync need longer
        $newCompTime = $null
        for ($i = 0; $i -lt 5; $i++ ) {
            Start-Sleep -Seconds 3
            if (![string]::IsNullOrWhiteSpace($ThreadSyncHash.DomainComputer_Domain)) {
                # custom domain
                $newCompTime = Get-LapsADPassword -Identity $ThreadSyncHash.DomainComputer_Identity -Domain $ThreadSyncHash.DomainComputer_Domain -ErrorAction SilentlyContinue -WarningAction SilentlyContinue | Select-Object ExpirationTimestamp
            }
            else {
                # defautl domain
                $newCompTime = Get-LapsADPassword -Identity $ThreadSyncHash.DomainComputer_Identity -ErrorAction SilentlyContinue -WarningAction SilentlyContinue | Select-Object ExpirationTimestamp
            }

            if ($newCompTime.ExpirationTimestamp.ToString() -eq $newExpTime.ToString()) {
                #stop loop if change success
                break;
            }
        }

        #Return state
        if ($newCompTime.ExpirationTimestamp.ToString() -ne $newExpTime.ToString()) {
            # Time has not changed
            $jobResult.StatusMessage = "Setting the time failed! - Reason unknown."
            $ThreadSyncHash.ThreadCommand_Result = "Failed"
            $ThreadSyncHash.ThreadCommand_Data = $jobResult
            $ThreadSyncHash.ThreadCommand_State = "CompletedTimeSet"
            return
        }
        else
        {
            # Time has changed
            # - Enable controls from "get password" background thread
            $jobResult.StatusMessage = "Changed the time successfully."
            $ThreadSyncHash.ThreadCommand_Result = "Success"
            $ThreadSyncHash.ThreadCommand_Data = $jobResult
            $ThreadSyncHash.ThreadCommand_State = "CompletedTimeSet"
            return
        }
    }
    catch {
        # Exception was thrown
        $jobResult.StatusMessage = "Setting the time failed! - Hover for more information."
        $jobResult.StatusExplain = "$($_.Exception.Message)"
        $ThreadSyncHash.ThreadCommand_Result = "Failed"
        $ThreadSyncHash.ThreadCommand_Data = $jobResult
        $ThreadSyncHash.ThreadCommand_State = "CompletedTimeSet"
        return
    }
}

# Button command for setting time
function Invoke-SetExpirationTimeBtnCmd($pForm)
{
    # Diasbel main form controls
    $compTextBox.Enabled = $false
    $GoButton.Enabled = $false
    $AccountNameCopyButton.Enabled = $false
    $AccountNamePreviewButton.Enabled = $false
    $PasswordCopyButton.Enabled = $false
    $PasswordPreviewButton.Enabled = $false
    $TimeSetButton.Enabled = $false
    $ListPwdHistory.Enabled = $false

    # Show form
    $compNameText.Text = "Computer: $($ThreadSyncHash.SearchComputerInput_Text)"
    $dateTime.Value = [datetime]::Now - [timespan]::FromMinutes(1)
    $dlgResult = $timeDialog.ShowDialog($pForm)

    # Execute result action
    if ($dlgResult -eq [System.Windows.Forms.DialogResult]::OK)
    {
        [datetime]$newExpTime = $dateTime.Value
        
        # Set state
        $TimeSetRunningGif.Image = $progressRunningGifImage
        $TimeSetRunningGif.Show()

        Set-StatusText -Text "Changing the time ..." -Color Black
        Start-Sleep -Milliseconds 250 # To show status correct.
        
        <# Test for required commandlet for legacy laps pc
        if (!$ThreadSyncHash.DomainComputer_HasWinLaps -and !$Script:IsLegacyLapsInstalled) {
            # return false; Legacy LAPS module not installed
            $compTextBox.Enabled = $true
            $GoButton.Enabled = $true
            $AccountNameCopyButton.Enabled = $true
            $AccountNamePreviewButton.Enabled = $true
            $PasswordCopyButton.Enabled = $true
            $PasswordPreviewButton.Enabled = $true
            $TimeSetButton.Enabled = $true
            $ListPwdHistory.Enabled = $true
        
            $TimeSetRunningGif.Image = $null
            $TimeSetRunningGif.Hide()
            Set-StatusText -Text "Setting the time failed: Legacy LAPS module is not installed!" -Color Red
            return
        }#>

        # execute change in sub thread        
        #############
		try {
			$RunspaceInstanceCache.PsInstance.EndInvoke($RunspaceInstanceCache.PsInvokationHandle)
		}
		catch { }
		$script:BgJobTimer.Start()
		$psThreadInstance.Commands.Clear()
        $ThreadSyncHash.ThreadCommand_Data = @{NewTime = $newExpTime}
		$psThreadInstance.AddScript($SetExpirationTimeScript)

		$Script:RunspaceInstanceCache.PsInstance = $psThreadInstance
		$Script:RunspaceInstanceCache.PsInvokationHandle = $psThreadInstance.BeginInvoke()
    }
    else
    {
        # Return $false on "Cancel" button
        $compTextBox.Enabled = $true
        $GoButton.Enabled = $true
        $AccountNameCopyButton.Enabled = $true
        $AccountNamePreviewButton.Enabled = $true
        $PasswordCopyButton.Enabled = $true
        $PasswordPreviewButton.Enabled = $true
        $TimeSetButton.Enabled = $true
        $ListPwdHistory.Enabled = $true
        
        $TimeSetRunningGif.Image = $null
        $TimeSetRunningGif.Hide()
        Set-StatusText -Text "Time change cancelled." -Color Black
        return
    }
}

# Function to update window content after background jobs finished
function Update-WindowAfterBgJob([ValidateSet('SearchPassword', 'SetTime')]$Job, [ValidateSet('Success', 'Aborted', 'Failed')]$JobResult) {
    # Search / get password => failed
    if ( ($Job -eq 'SearchPassword') -and ($JobResult -eq 'Failed') ) {
        $compTextBox.Enabled = $true
        $ListPwdHistory.Enabled = $true
        $SearchRunningGif.Image = $null
        $SearchRunningGif.Hide()
        $TimeSetRunningGif.Image = $null
        $TimeSetRunningGif.Hide()
        $GoButton.Enabled = $true
        # -- enabled states after time set
        $AccountNameCopyButton.Enabled = $true
        $AccountNamePreviewButton.Enabled = $true
        $PasswordCopyButton.Enabled = $true
        $PasswordPreviewButton.Enabled = $true
        $TimeSetButton.Enabled = $true
        # ------------------------------
        if ($ThreadSyncHash.ThreadCommand_Data.StatusExplain -ne [string]::Empty) {
            Set-StatusText -Text $ThreadSyncHash.ThreadCommand_Data.StatusMessage `
                -AccessibleText "Setting the time failed: $($ThreadSyncHash.ThreadCommand_Data.StatusExplain)" `
                -ToolTipText $ThreadSyncHash.ThreadCommand_Data.StatusExplain `
                -Color Red
        }
        else {
            Set-StatusText -Text $ThreadSyncHash.ThreadCommand_Data.StatusMessage -Color Red
        }
    }
    # Search / get password => success
    elseif ( ($Job -eq 'SearchPassword') -and ($JobResult -eq 'Success') ) {
        # -- enabled states after time set
        $AccountNameCopyButton.Enabled = $true
        $AccountNamePreviewButton.Enabled = $true
        $PasswordCopyButton.Enabled = $true
        $PasswordPreviewButton.Enabled = $true
        $TimeSetButton.Enabled = $true
        # ------------------------------
        if ($null -ne $ThreadSyncHash.ThreadCommand_Data.Password) {
            # password data found
            if ($ThreadSyncHash.DomainComputer_HasWinLaps) {
                # win laps with account
                $AccountNameData.Text = $ThreadSyncHash.ThreadCommand_Data.Account
                $AccountNameCopyButton.Show()
                $AccountNamePreviewButton.Show()
            }
            $PasswordData.Text = $ThreadSyncHash.ThreadCommand_Data.Password
            $PasswordCopyButton.Show()
            $PasswordPreviewButton.Show()
            $ExpirationTimeData.Text = $ThreadSyncHash.ThreadCommand_Data.ExpirationTime
            if (!$ThreadSyncHash.DomainComputer_HasWinLaps -and !$Script:IsLegacyLapsInstalled) {
                # Legacy LAPS and module not installed: Setting time not supported.
                $TimeSetNoLegacyModuleText.Show()
            }
            elseif (!$ThreadSyncHash.DomainComputer_HasWinLaps -and ![string]::IsNullOrWhiteSpace($ThreadSyncHash.DomainComputer_Domain)) {
                # Legacy Laps and custom domain: Setting time not supported.
                $TimeSetNotSupportedText.Show()
            }
            else {
                $TimeSetButton.Show()
            }
            Update-PasswordHistoryListView -PwdList $ThreadSyncHash.ThreadCommand_Data.PwdHistory
        }
        $compTextBox.Enabled = $true
        $ListPwdHistory.Enabled = $true
        $SearchRunningGif.Image = $null
        $SearchRunningGif.Hide()
        $TimeSetRunningGif.Image = $null
        $TimeSetRunningGif.Hide()
        $GoButton.Enabled = $true
        Set-StatusText -Text $ThreadSyncHash.ThreadCommand_Data.StatusMessage -Color Green
    }
    # Time set => failed
    elseif ( ($Job -eq 'SetTime') -and ($JobResult -eq 'Failed') ) {
        $compTextBox.Enabled = $true
        $GoButton.Enabled = $true
        $AccountNameCopyButton.Enabled = $true
        $AccountNamePreviewButton.Enabled = $true
        $PasswordCopyButton.Enabled = $true
        $PasswordPreviewButton.Enabled = $true
        $TimeSetButton.Enabled = $true
        $ListPwdHistory.Enabled = $true
        $TimeSetRunningGif.Image = $null
        $TimeSetRunningGif.Hide()
        if ($ThreadSyncHash.ThreadCommand_Data.StatusExplain -ne [string]::Empty) {
            Set-StatusText -Text $ThreadSyncHash.ThreadCommand_Data.StatusMessage `
                -AccessibleText "Setting the time failed: $($ThreadSyncHash.ThreadCommand_Data.StatusExplain)" `
                -ToolTipText $ThreadSyncHash.ThreadCommand_Data.StatusExplain `
                -Color Red
        }
        else {
            Set-StatusText -Text $ThreadSyncHash.ThreadCommand_Data.StatusMessage -Color Red
        }
    }
    # Time set => success
    elseif ( ($Job -eq 'SetTime') -and ($JobResult -eq 'Success') ) {
        # Gui elements are enabled later after datat update
        Set-StatusText -Text $ThreadSyncHash.ThreadCommand_Data.StatusMessage -Color Green
        Start-Sleep -Milliseconds 25 # To show status correct.
    }
}

# Function to update list view after searching passwords
# - Move to a separate function to keep code in <Update-WindowAfterBgJob> more clean
function Update-PasswordHistoryListView ($pwdList) {
    [int]$resizeAccountColumnStyle = [System.Windows.Forms.ColumnHeaderAutoResizeStyle]::HeaderSize
    [Int]$resizePasswordColumnStyle = [System.Windows.Forms.ColumnHeaderAutoResizeStyle]::HeaderSize

    # Update listview content
    if ($pwdList.length -gt 0)
    {
        foreach ($hPwd in $pwdList) {
            if ($null -eq $hPwd) {
                continue;
            }
            if ($null -eq $hPwd.PasswordUpdateTime) {
                continue;
            }
            if ($null -eq $hPwd.Password) {
                continue;
            }

            # Decide best column resize mode
            if ($hPwd.Account.Length -gt "User name".Length) {
                $resizeAccountColumnStyle = [System.Windows.Forms.ColumnHeaderAutoResizeStyle]::ColumnContent
            }
            if ($hPwd.Password.Length -gt "Password".Length) {
                $resizePasswordColumnStyle = [System.Windows.Forms.ColumnHeaderAutoResizeStyle]::ColumnContent
            }

            $item = New-Object System.Windows.Forms.ListViewItem($hPwd.PasswordUpdateTime.ToString())
            $item.SubItems.Add($hPwd.Account)
            $item.SubItems.Add($hPwd.Password)
            [void]$ListPwdHistory.Items.Add($item)
        }
    }

    # Set empty history info and resize columns
    if ($ListPwdHistory.Items.Count -eq 0) {
        $item = New-Object System.Windows.Forms.ListViewItem("")
        $item.SubItems.Add("(No history items available.)")
        [void]$ListPwdHistory.Items.Add($item)

        # Resize columns as needed for "no history" info and nice view
        [void]$ListPwdHistory.AutoResizeColumn(0,1)
        [void]$ListPwdHistory.AutoResizeColumn(1,2)
        [void]$ListPwdHistory.AutoResizeColumn(2,1)
    }
    else {
        # Resize all columns based on the best way
        [void]$ListPwdHistory.AutoResizeColumn(0,1)
        [void]$ListPwdHistory.AutoResizeColumn(1,$resizeAccountColumnStyle)
        [void]$ListPwdHistory.AutoResizeColumn(2,$resizePasswordColumnStyle)
    }
}

# Code to add line breaks to password in preview window. (Not realted to background job logic.)
function AddLineBreaksForPasswordPreview ([string]$pwdString) {
    if ($pwdString.Length -gt 24) {
        $pwdString = $pwdString.Insert(24, [System.Environment]::NewLine)
    }
    if ($pwdString.Length -gt 50) {
        $pwdString = $pwdString.Insert(50, [System.Environment]::NewLine)
    }
    return $pwdString
}





### Zoom dialog
############################################################################

$zoomDialog = New-Object system.Windows.Forms.Form
$zoomDialog.SuspendLayout(); # Very important to correctly size and position all controls!
$zoomDialog.AutoScaleDimensions =  New-Object System.Drawing.SizeF(96, 96)
$zoomDialog.AutoScaleMode  = [System.Windows.Forms.AutoScaleMode]::DPI
$zoomDialog.StartPosition = 'CenterParent'
$zoomDialog.Size = "470,320"
$zoomDialog.text = ""
$zoomDialog.BackColor = 'GhostWhite'
$zoomDialog.FormBorderStyle='FixedToolWindow'
$zoomDialog.ShowInTaskbar = $False
$zoomDialog.ControlBox = $false
$zoomDialog.KeyPreview = $true
$zoomDialog.AccessibleName = 'Zoom preview'
$zoomDialog.AccessibleRole = 'Window'
$zoomDialog.Add_KeyUp({if ($_.KeyCode -eq "Escape") {$timeDialog.Close()}})


$zoomDlgAccountHeaderLabel = New-Object system.Windows.Forms.Label
$zoomDlgAccountHeaderLabel.Location = New-Object System.Drawing.Point(10,6)
$zoomDlgAccountHeaderLabel.Size = New-Object System.Drawing.Point(95,25)
$zoomDlgAccountHeaderLabel.Font = [System.Drawing.Font]::new("Segoe UI", 12, [System.Drawing.FontStyle]::Bold)
$zoomDlgAccountHeaderLabel.ForeColor = "Black"
$zoomDlgAccountHeaderLabel.BackColor = "GhostWhite"
$zoomDlgAccountHeaderLabel.Text = "User name"
$zoomDialog.Controls.Add($zoomDlgAccountHeaderLabel)

$zoomDlgAccountHeaderLine = New-Object system.Windows.Forms.Label
$zoomDlgAccountHeaderLine.Location = New-Object System.Drawing.Point(20,17)
$zoomDlgAccountHeaderLine.Size = New-Object System.Drawing.Point(435,4)
$zoomDlgAccountHeaderLine.BackColor = "LightGray"
$zoomDlgAccountHeaderLine.BorderStyle = "None"
$zoomDlgAccountHeaderLine.AutoSize = $flase
$zoomDlgAccountHeaderLine.AccessibleRole = 'Separator'
$zoomDialog.Controls.Add($zoomDlgAccountHeaderLine)

$zoomDlgAccount = New-Object system.Windows.Forms.Label
$zoomDlgAccount.Location = New-Object System.Drawing.Point(30,35)
$zoomDlgAccount.Size = New-Object System.Drawing.Point(400,50)
$zoomDlgAccount.Font = [System.Drawing.Font]::new("Consolas", 20, [System.Drawing.FontStyle]::Bold)
$zoomDlgAccount.ForeColor = "Black"
$zoomDlgAccount.AutoEllipsis = $true
$zoomDlgAccount.Text = ""
$zoomDialog.Controls.Add($zoomDlgAccount)

$zoomDlgPasswordHeaderLabel = New-Object system.Windows.Forms.Label
$zoomDlgPasswordHeaderLabel.Location = New-Object System.Drawing.Point(10,106)
$zoomDlgPasswordHeaderLabel.Size = New-Object System.Drawing.Point(85,25)
$zoomDlgPasswordHeaderLabel.Font = [System.Drawing.Font]::new("Segoe UI", 12, [System.Drawing.FontStyle]::Bold)
$zoomDlgPasswordHeaderLabel.ForeColor = "Black"
$zoomDlgPasswordHeaderLabel.BackColor = "GhostWhite"
$zoomDlgPasswordHeaderLabel.Text = "Password"
$zoomDialog.Controls.Add($zoomDlgPasswordHeaderLabel)

$zoomDlgPasswordHeaderLine = New-Object system.Windows.Forms.Label
$zoomDlgPasswordHeaderLine.Location = New-Object System.Drawing.Point(20,117)
$zoomDlgPasswordHeaderLine.Size = New-Object System.Drawing.Point(435,4)
$zoomDlgPasswordHeaderLine.BackColor = "LightGray"
$zoomDlgPasswordHeaderLine.BorderStyle = "None"
$zoomDlgPasswordHeaderLine.AutoSize = $flase
$zoomDlgPasswordHeaderLine.AccessibleRole = 'Separator'
$zoomDialog.Controls.Add($zoomDlgPasswordHeaderLine)

$zoomDlgPassword = New-Object system.Windows.Forms.Label
$zoomDlgPassword.Location = New-Object System.Drawing.Point(30,135)
$zoomDlgPassword.Size = New-Object System.Drawing.Point(400,100)
$zoomDlgPassword.Font = [System.Drawing.Font]::new("Consolas", 20, [System.Drawing.FontStyle]::Bold)
$zoomDlgPassword.ForeColor = "Black"
$zoomDlgPassword.AutoEllipsis = $true
$zoomDlgPassword.Text = ""
$zoomDialog.Controls.Add($zoomDlgPassword)

$bZoomCloes = New-Object System.Windows.Forms.Button
$bZoomCloes.Text = "Close"
$bZoomCloes.Font = [System.Drawing.Font]::new("Segoe UI", 12, [System.Drawing.FontStyle]::Bold)
$bZoomCloes.ForeColor = "blue"
$bZoomCloes.Size = "150,30"
$bZoomCloes.Location = "160,260"
$bZoomCloes.Add_Click({$zoomDialog.Close()})
$bZoomCloes.DialogResult = "Cancel"
$zoomDialog.Controls.Add($bZoomCloes)

# Very important to correctly size and position all controls!
$zoomDialog.ResumeLayout();





### Time set dialog
############################################################################

$timeDialog = New-Object system.Windows.Forms.Form
$timeDialog.SuspendLayout(); # Very important to correctly size and position all controls!
$timeDialog.AutoScaleDimensions =  New-Object System.Drawing.SizeF(96, 96)
$timeDialog.AutoScaleMode  = [System.Windows.Forms.AutoScaleMode]::Dpi
$timeDialog.StartPosition = 'CenterParent'
$timeDialog.Size = "235,150"
$timeDialog.text = ""
$timeDialog.BackColor = 'GhostWhite'
$timeDialog.FormBorderStyle='FixedToolWindow'
$timeDialog.ShowInTaskbar = $False
$timeDialog.ControlBox = $false
$timeDialog.KeyPreview = $true
$timeDialog.AccessibleName = 'Change expiration time'
$timeDialog.AccessibleRole = 'Dialog'
$timeDialog.Add_KeyUp({if ($_.KeyCode -eq "Escape") {$timeDialog.Close()}})

$header = New-Object System.Windows.Forms.Label
$header.Text = "Set new time?"
$header.TextAlign = "TopCenter"
$header.Font = New-Object System.Drawing.Font("Segeo UI", 12, [System.Drawing.FontStyle]::Bold)
$header.Height = 30
$header.Width = $timeDialog.Width
$header.Location = "0,15"
$timeDialog.Controls.Add($header)

$compNameText = New-Object System.Windows.Forms.Label
$compNameText.TextAlign = "TopCenter"
$compNameText.Font = New-Object System.Drawing.Font("Segeo UI", 10)
$compNameText.ForeColor = "Gray"
$compNameText.Height = 30
$compNameText.Width = $timeDialog.Width
$compNameText.Location = "0,45"
$timeDialog.Controls.Add($compNameText)

$currentDTFormat = [cultureinfo]::CurrentCulture.DateTimeFormat
$dateTime = New-Object System.Windows.Forms.DateTimePicker
$dateTime.Font = New-Object System.Drawing.Font("Segeo UI", 12)
$dateTime.ShowUpDown = $true
$dateTime.Format = "Custom"
$dateTime.CustomFormat = "$($currentDTFormat.ShortDatePattern)  $($currentDTFormat.ShortTimePattern)"
if ($currentDTFormat.ShortTimePattern -like '*tt') {
    # if with am/pm, we need a bigger input field
    $dateTime.Width = "200"
    $dateTime.Location = "20,75"
}
else {
    $dateTime.Width = "170"
    $dateTime.Location = "35,75"
}
$timeDialog.Controls.Add($dateTime)

$bOK = New-Object System.Windows.Forms.Button
$bOK.Text = "Set"
$bOK.Font = New-Object System.Drawing.Font("Segeo UI", 10)
$bOK.ForeColor = "green"
$bOK.Location = "30,115"
$bOK.Add_Click({$timeDialog.Close()})
$bOK.DialogResult = "OK"
$timeDialog.Controls.Add($bOK)
$timeDialog.AcceptButton = $bOK

$bCancel = New-Object System.Windows.Forms.Button
$bCancel.Text = "Cancel"
$bCancel.Font = New-Object System.Drawing.Font("Segeo UI", 10)
$bCancel.ForeColor = "red"
$bCancel.Location = "130,115"
$bCancel.Add_Click({$timeDialog.Close()})
$bCancel.DialogResult = "Cancel"
$timeDialog.Controls.Add($bCancel)

# Very important to correctly size and position all controls!
$timeDialog.ResumeLayout();





### About window
############################################################################

$aboutForm = New-Object System.Windows.Forms.Form
$aboutForm.SuspendLayout(); # Very important to correctly size and position all controls!
$aboutForm.AutoScaleDimensions =  New-Object System.Drawing.SizeF(96, 96)
$aboutForm.AutoScaleMode  = [System.Windows.Forms.AutoScaleMode]::Dpi
$aboutForm.BackColor = "White"
$aboutForm.ClientSize = "315, 180"
$aboutForm.MinimizeBox = $false
$aboutForm.MaximizeBox = $false
$aboutForm.ShowInTaskBar = $false
$aboutForm.FormBorderStyle = "FixedDialog"
$aboutForm.StartPosition = "CenterParent"
$aboutForm.Text = "About Simple LAPS GUI"
$aboutForm.AccessibleRole = 'Window'
$aboutForm.KeyPreview = $true
$aboutForm.Add_KeyUp({if ($_.KeyCode -eq "Escape") {$aboutForm.Close()}})

$aboutFormImage = New-Object System.Windows.Forms.PictureBox
$aboutFormImage.Image = $windowIconImage.ToBitmap()
$aboutFormImage.Location = "25, 20"
$aboutFormImage.Size = "64, 64"
$aboutFormImage.SizeMode = "StretchImage"
$aboutFormImage.AccessibleDescription = 'Application logo'
$aboutForm.Controls.Add($aboutFormImage)

$aboutFormNameLabel = New-Object System.Windows.Forms.Label
$aboutFormNameLabel.Font = New-Object Drawing.Font("Segeo UI", 10, [System.Drawing.FontStyle]::Bold)
$aboutFormNameLabel.Location = "110, 20"
$aboutFormNameLabel.Size = "200, 18"
$aboutFormNameLabel.Text = "Simple LAPS GUI  $scriptVersion"
$aboutForm.Controls.Add($aboutFormNameLabel)
 
$aboutFormAuthor = New-Object System.Windows.Forms.Label
$aboutFormAuthor.Font = New-Object Drawing.Font("Segeo UI", 8)
$aboutFormAuthor.Location = "110, 40"
$aboutFormAuthor.Size = "300, 15"
$aboutFormAuthor.Text = "Heiko Horwedel (htcfreek)"
$aboutFormAuthor.AccessibleName = "Written by Heiko Horwedel (htcfreek)"
$aboutForm.Controls.Add($aboutFormAuthor)

$aboutLicense = New-Object System.Windows.Forms.Label
$aboutLicense.Font = New-Object Drawing.Font("Segeo UI", 8)
$aboutLicense.Location = "110, 58"
$aboutLicense.Size = "300, 20"
$aboutLicense.Text = "MIT License"
$aboutLicense.AccessibleName = "The app is published under the MIT license."
$aboutForm.Controls.Add($aboutLicense)

$aboutDownloadLink = New-Object System.Windows.Forms.LinkLabel
$aboutDownloadLink.Font = New-Object Drawing.Font("Segeo UI", 8)
$aboutDownloadLink.Location = "110, 85"
$aboutDownloadLink.Size = "300, 20"
$aboutDownloadLink.AccessibleRole = 'Link'
$aboutDownloadLink.Text = "Check for new version online"
$aboutDownloadLink.add_Click({[system.Diagnostics.Process]::start("https://github.com/htcfreek/SimpleLapsGui/releases/latest")})
$aboutForm.Controls.Add($aboutDownloadLink)
$tt1 = New-Object System.Windows.Forms.ToolTip
$tt1.SetToolTip($aboutDownloadLink, "https://github.com/htcfreek/SimpleLapsGui/releases/latest")

$aboutLicenseLink = New-Object System.Windows.Forms.LinkLabel
$aboutLicenseLink.Font = New-Object Drawing.Font("Segeo UI", 8)
$aboutLicenseLink.Location = "110, 105"
$aboutLicenseLink.Size = "300, 20"
$aboutLicenseLink.AccessibleRole = 'Link'
$aboutLicenseLink.Text = "Read license file online"
$aboutLicenseLink.add_Click({[system.Diagnostics.Process]::start("https://github.com/htcfreek/SimpleLapsGui/blob/main/LICENSE.md")})
$aboutForm.Controls.Add($aboutLicenseLink)
$tt2 = New-Object System.Windows.Forms.ToolTip
$tt2.SetToolTip($aboutLicenseLink, "https://github.com/htcfreek/SimpleLapsGui/blob/main/LICENSE.md")

$aboutFormRepoLink = New-Object System.Windows.Forms.LinkLabel
$aboutFormRepoLink.Font = New-Object Drawing.Font("Segeo UI", 8)
$aboutFormRepoLink.Location = "110, 125"
$aboutFormRepoLink.Size = "300, 20"
$aboutFormRepoLink.AccessibleRole = 'Link'
$aboutFormRepoLink.Text = "GitHub Repository"
$aboutFormRepoLink.add_Click({[system.Diagnostics.Process]::start("https://github.com/htcfreek/SimpleLapsGui")})
$aboutForm.Controls.Add($aboutFormRepoLink)
$tt3 = New-Object System.Windows.Forms.ToolTip
$tt3.SetToolTip($aboutFormRepoLink, "https://github.com/htcfreek/SimpleLapsGui")

$aboutFormAuthorLink = New-Object System.Windows.Forms.LinkLabel
$aboutFormAuthorLink.Font = New-Object Drawing.Font("Segeo UI", 8)
$aboutFormAuthorLink.Location = "110, 145"
$aboutFormAuthorLink.Size = "300, 20"
$aboutFormAuthorLink.AccessibleRole = 'Link'
$aboutFormAuthorLink.Text = "GitHub Profile"
$aboutFormAuthorLink.add_Click({[system.Diagnostics.Process]::start("https://github.com/htcfreek")})
$aboutForm.Controls.Add($aboutFormAuthorLink)
$tt4 = New-Object System.Windows.Forms.ToolTip
$tt4.SetToolTip($aboutFormAuthorLink, "https://github.com/htcfreek")

# Very important to correctly size and position all controls!
$aboutForm.ResumeLayout();





### App main window
############################################################################

$headerFont = [System.Drawing.Font]::new("Segoe UI", 12, [System.Drawing.FontStyle]::Bold)
$pwdFont = [System.Drawing.Font]::new("Consolas",10, [System.Drawing.FontStyle]::Bold)
$textFont = [System.Drawing.Font]::new("Segoe UI",10, [System.Drawing.FontStyle]::Regular)
$hintFont = [System.Drawing.Font]::new("Segoe UI",8, [System.Drawing.FontStyle]::Italic)
$pwdHistoryHeaderFont = [System.Drawing.Font]::new("Segoe UI", 8)
$pwdHistoryFont = [System.Drawing.Font]::new("Consolas",8)
$statusBarFont = [System.Drawing.Font]::new("Segoe UI", 8)

$mainForm = New-Object System.Windows.Forms.Form
$mainForm.SuspendLayout(); # Very important to correctly size and position all controls!
$mainForm.AutoScaleDimensions =  New-Object System.Drawing.SizeF(96, 96)
$mainForm.AutoScaleMode  = [System.Windows.Forms.AutoScaleMode]::Dpi
$mainForm.Backcolor="white"
$mainForm.Size = New-Object System.Drawing.Size(535,410)
$mainForm.FormBorderStyle = "FixedDialog"
$mainForm.StartPosition = "CenterScreen"
$mainForm.MinimizeBox = $true
$mainForm.MaximizeBox = $false
$mainForm.Text = $windowTitle
$mainForm.AccessibleRole = 'Window'
#---
$mainForm.ShowIcon = $true
$mainForm.Icon = $windowIconImage


# ----- Area: Computer name ----------------------
$CompHeaderLabel = New-Object system.Windows.Forms.Label
$CompHeaderLabel.Location = New-Object System.Drawing.Point(10,6)
$CompHeaderLabel.Size = New-Object System.Drawing.Point(150,25)
$CompHeaderLabel.Font = $headerFont
$CompHeaderLabel.ForeColor = "Black"
$CompHeaderLabel.BackColor = "White"
$CompHeaderLabel.Text = "Search Computer"
$mainForm.Controls.Add($CompHeaderLabel)

$CompHeaderLine = New-Object system.Windows.Forms.Label
$CompHeaderLine.Location = New-Object System.Drawing.Point(30,17)
$CompHeaderLine.Size = New-Object System.Drawing.Point(480,4)
$CompHeaderLine.BackColor = "LightGray"
$CompHeaderLine.BorderStyle = "None"
$CompHeaderLine.AutoSize = $flase
$CompHeaderLine.AccessibleRole = 'Separator'
$mainForm.Controls.Add($CompHeaderLine)

$compTextBox = New-Object System.Windows.Forms.TextBox
$compTextBox.Location = New-Object System.Drawing.Size(15,37)
$compTextBox.Size = New-Object System.Drawing.Size(365,50)
$compTextBox.Font = $textFont
$compTextBox.AccessibleName = 'Computer name to search'
$compTextBox.AccessibleRole = 'Text'
$mainForm.Controls.Add($compTextBox)

$GoButton = New-Object System.Windows.Forms.Button
$GoButton.Location = New-Object System.Drawing.Size(400,35)
$GoButton.Size = New-Object System.Drawing.Size(75,25)
$GoButton.Text = "Search"
$GoButton.Font = $textFont
$GoButton.Add_Click({ Invoke-GetPasswordBtnCmd; })
$mainForm.Controls.Add($GoButton)
$mainForm.AcceptButton = $GoButton

$SearchRunningGif = New-Object System.Windows.Forms.PictureBox
$SearchRunningGif.Location = New-Object System.Drawing.Size(483,38)
$SearchRunningGif.Size = New-Object System.Drawing.Size(19,19)
$SearchRunningGif.SizeMode = 'Zoom'
$SearchRunningGif.AccessibleName = 'Search executing indication'
$SearchRunningGif.Hide()
$SearchRunningGif.Image = $null
$mainForm.Controls.Add($SearchRunningGif)

$CompInfoText = New-Object system.Windows.Forms.Label
$CompInfoText.Font = $hintFont
$CompInfoText.ForeColor = "Blue"
$CompInfoText.BackColor = "White"
$CompInfoText.Location = New-Object System.Drawing.Point(15,62)
$CompInfoText.Size = New-Object System.Drawing.Point(365,15)
$CompInfoText.Text = "Use Domain\Computer or the FQDN to specify a custom domain."
$mainForm.Controls.Add($CompInfoText)

# ----- Area: Current Account ----------------------
$AccountHeaderLabel = New-Object system.Windows.Forms.Label
$AccountHeaderLabel.Location = New-Object System.Drawing.Point(10,85)
$AccountHeaderLabel.Size = New-Object System.Drawing.Point(165,20)
$AccountHeaderLabel.Font = $headerFont
$AccountHeaderLabel.ForeColor = "Black"
$AccountHeaderLabel.BackColor = "White"
$AccountHeaderLabel.Text = "Local Administrator"
$mainForm.Controls.Add($AccountHeaderLabel)

$AccountHeaderLine = New-Object system.Windows.Forms.Label
$AccountHeaderLine.Location = New-Object System.Drawing.Point(30,96)
$AccountHeaderLine.Size = New-Object System.Drawing.Point(480,4)
$AccountHeaderLine.BackColor = "LightGray"
$AccountHeaderLine.BorderStyle = "None"
$AccountHeaderLine.AutoSize = $flase
$AccountHeaderLine.AccessibleRole = 'Separator'
$mainForm.Controls.Add($AccountHeaderLine)

$AccountNameLabel = New-Object system.Windows.Forms.Label
$AccountNameLabel.Location = New-Object System.Drawing.Point(15,111)
$AccountNameLabel.Size = New-Object System.Drawing.Point(75,20)
$AccountNameLabel.Font = $textFont
$AccountNameLabel.ForeColor = "Black"
$AccountNameLabel.Text = "User name:"
$mainForm.Controls.Add($AccountNameLabel)

$AccountNameData = New-Object system.Windows.Forms.Label
$AccountNameData.Location = New-Object System.Drawing.Point(90,114)
$AccountNameData.Size = New-Object System.Drawing.Point(310,20)
$AccountNameData.Font = $pwdFont
$AccountNameData.ForeColor = "Black"
$AccountNameData.Text = ""
$AccountNameData.AccessibleDescription = 'User name of current account'
$mainForm.Controls.Add($AccountNameData)

$AccountNameCopyButton = New-Object System.Windows.Forms.Button
$AccountNameCopyButton.Location = New-Object System.Drawing.Size(400,109)
$AccountNameCopyButton.Size = New-Object System.Drawing.Size(75,25)
$AccountNameCopyButton.Text = "Copy"
$AccountNameCopyButton.AccessibleName = 'Copy user name'
$AccountNameCopyButton.Font = $textFont
$AccountNameCopyButton.Hide()
$AccountNameCopyButton.Add_Click({Set-Clipboard $AccountNameData.Text})
$mainForm.Controls.Add($AccountNameCopyButton)

$AccountNamePreviewButton = New-Object System.Windows.Forms.Button
$AccountNamePreviewButton.Location = New-Object System.Drawing.Size(480,109)
$AccountNamePreviewButton.Size = New-Object System.Drawing.Size(25,25)
$AccountNamePreviewButton.Text = ""
$AccountNamePreviewButton.AccessibleName = "Zoom preview"
$AccountNamePreviewButton.Font = $textFont
$AccountNamePreviewButton.BackgroundImage = $magnifyIconImage
$AccountNamePreviewButton.BackgroundImageLayout = 'Stretch'
$AccountNamePreviewButton.Hide()
$AccountNamePreviewButton.Add_Click({
    Set-MainWindowControlsDisabled
    $zoomDlgAccount.Text = $AccountNameData.Text;
    $zoomDlgPassword.Text = AddLineBreaksForPasswordPreview $PasswordData.Text;
    $zoomDialog.ShowDialog($mainForm)
    Set-MainWindowControlsEnabled})
$mainForm.Controls.Add($AccountNamePreviewButton)

$PasswordLabel = New-Object system.Windows.Forms.Label
$PasswordLabel.Location = New-Object System.Drawing.Point(15,140)
$PasswordLabel.Size = New-Object System.Drawing.Point(75,20)
$PasswordLabel.Font = $textFont
$PasswordLabel.ForeColor = "Black"
$PasswordLabel.Text = "Password:"
$mainForm.Controls.Add($PasswordLabel)

$PasswordData = New-Object system.Windows.Forms.Label
$PasswordData.Location = New-Object System.Drawing.Point(90,142)
$PasswordData.Size = New-Object System.Drawing.Point(310,20)
$PasswordData.Font = $pwdFont
$PasswordData.ForeColor = "Black"
$PasswordData.Text = ""
$PasswordData.AutoEllipsis = $true
$PasswordData.AccessibleDescription = 'Password of current account'
$mainForm.Controls.Add($PasswordData)

$PasswordCopyButton = New-Object System.Windows.Forms.Button
$PasswordCopyButton.Location = New-Object System.Drawing.Size(400,138)
$PasswordCopyButton.Size = New-Object System.Drawing.Size(75,25)
$PasswordCopyButton.Text = "Copy"
$PasswordCopyButton.AccessibleName = 'Copy password'
$PasswordCopyButton.Font = $textFont
$PasswordCopyButton.Hide()
$PasswordCopyButton.Add_Click({Set-Clipboard $PasswordData.Text.Trim()})
$mainForm.Controls.Add($PasswordCopyButton)

$PasswordPreviewButton = New-Object System.Windows.Forms.Button
$PasswordPreviewButton.Location = New-Object System.Drawing.Size(480,138)
$PasswordPreviewButton.Size = New-Object System.Drawing.Size(25,25)
$PasswordPreviewButton.Text = ""
$PasswordPreviewButton.AccessibleName = "Zoom preview"
$PasswordPreviewButton.Font = $textFont
$PasswordPreviewButton.BackgroundImage = $magnifyIconImage
$PasswordPreviewButton.BackgroundImageLayout = 'Stretch'
$PasswordPreviewButton.Hide()
$PasswordPreviewButton.Add_Click({
    Set-MainWindowControlsDisabled
    $zoomDlgAccount.Text = $AccountNameData.Text;
    $zoomDlgPassword.Text = AddLineBreaksForPasswordPreview $PasswordData.Text;
    $zoomDialog.ShowDialog($mainForm)
    Set-MainWindowControlsEnabled})
$mainForm.Controls.Add($PasswordPreviewButton)

$ExpirationTimeLabel = New-Object system.Windows.Forms.Label
$ExpirationTimeLabel.Location = New-Object System.Drawing.Point(15,168)
$ExpirationTimeLabel.Size = New-Object System.Drawing.Point(75,20)
$ExpirationTimeLabel.Font = $textFont
$ExpirationTimeLabel.ForeColor = "Black"
$ExpirationTimeLabel.Text = "Expires on:"
$mainForm.Controls.Add($ExpirationTimeLabel)

$ExpirationTimeData = New-Object system.Windows.Forms.Label
$ExpirationTimeData.Location = New-Object System.Drawing.Point(90,168)
$ExpirationTimeData.Size = New-Object System.Drawing.Point(160,20)
$ExpirationTimeData.Font = $textFont
$ExpirationTimeData.ForeColor = "Black"
$ExpirationTimeData.Text = ""
$ExpirationTimeData.AccessibleDescription = 'Expiration time of current account'
$mainForm.Controls.Add($ExpirationTimeData)

$TimeSetButton = New-Object System.Windows.Forms.Button
$TimeSetButton.Location = New-Object System.Drawing.Size(400,166)
$TimeSetButton.Size = New-Object System.Drawing.Size(75,25)
$TimeSetButton.Text = "Change"
$TimeSetButton.AccessibleName = 'Change expiration time'
$TimeSetButton.Font = $textFont
$TimeSetButton.Hide()
$TimeSetButton.Add_Click({
    Set-MainWindowControlsDisabled
    Invoke-SetExpirationTimeBtnCmd -pForm ($mainForm);
    # Controls are enabled from background threads
})
$mainForm.Controls.Add($TimeSetButton)

$TimeSetRunningGif = New-Object System.Windows.Forms.PictureBox
$TimeSetRunningGif.Location = New-Object System.Drawing.Size(483,169)
$TimeSetRunningGif.Size = New-Object System.Drawing.Size(19,19)
$TimeSetRunningGif.SizeMode = 'Zoom'
$TimeSetRunningGif.AccessibleName = 'Setting time in progress indication'
$TimeSetRunningGif.Image = $null
$TimeSetRunningGif.Hide()
$mainForm.Controls.Add($TimeSetRunningGif)

$TimeSetNotSupportedText = New-Object system.Windows.Forms.Label
$TimeSetNotSupportedText.Location = New-Object System.Drawing.Point(335,164)
$TimeSetNotSupportedText.Size = New-Object System.Drawing.Point(250,30)
$TimeSetNotSupportedText.Font = $hintFont
$TimeSetNotSupportedText.ForeColor = "Red"
$TimeSetNotSupportedText.Text = "(Changing the time is not supported`nfor Legacy Laps and custom domain.)"
$TimeSetNotSupportedText.Hide()
$mainForm.Controls.Add($TimeSetNotSupportedText)

$TimeSetNoLegacyModuleText = New-Object system.Windows.Forms.Label
$TimeSetNoLegacyModuleText.Location = New-Object System.Drawing.Point(360,164)
$TimeSetNoLegacyModuleText.Size = New-Object System.Drawing.Point(250,30)
$TimeSetNoLegacyModuleText.Font = $hintFont
$TimeSetNoLegacyModuleText.ForeColor = "Red"
$TimeSetNoLegacyModuleText.Text = "(Changing the time requires an`ninnstalled Legacy Laps module.)"
$TimeSetNoLegacyModuleText.Hide()
$mainForm.Controls.Add($TimeSetNoLegacyModuleText)

# ----- Area: Password history ----------------------
$HistoryHeaderLabel = New-Object system.Windows.Forms.Label
$HistoryHeaderLabel.Location = New-Object System.Drawing.Point(10,195)
$HistoryHeaderLabel.Size = New-Object System.Drawing.Point(70,25)
$HistoryHeaderLabel.Font = $headerFont
$HistoryHeaderLabel.ForeColor = "Black"
$HistoryHeaderLabel.BackColor = "White"
$HistoryHeaderLabel.Text = "History"
$mainForm.Controls.Add($HistoryHeaderLabel)

$HistoryHeaderLine = New-Object system.Windows.Forms.Label
$HistoryHeaderLine.Location = New-Object System.Drawing.Point(30,206)
$HistoryHeaderLine.Size = New-Object System.Drawing.Point(480,4)
$HistoryHeaderLine.BackColor = "LightGray"
$HistoryHeaderLine.BorderStyle = "None"
$HistoryHeaderLine.AutoSize = $flase
$HistoryHeaderLine.AccessibleRole = 'Separator'
$mainForm.Controls.Add($HistoryHeaderLine)

$ListPwdHistory = New-Object System.Windows.Forms.ListView
$ListPwdHistory.Location = New-Object System.Drawing.Size(15,228)
$ListPwdHistory.Size = New-Object System.Drawing.Size(488,110)
$ListPwdHistory.Font=$pwdHistoryFont
$ListPwdHistory.ForeColor = "Gray"
$ListPwdHistory.View = 'Details'
$ListPwdHistory.Sorting = "None"
$ListPwdHistory.HeaderStyle = "Nonclickable"
$ListPwdHistory.ShowItemToolTips = $true
$ListPwdHistory.MultiSelect = $false
$ListPwdHistory.FullRowSelect = $true
$ListPwdHistory.AccessibleName = 'Password history'
[void]$ListPwdHistory.Columns.Add('Replaced on',122)
[void]$ListPwdHistory.Columns.Add('User name',232)
[void]$ListPwdHistory.Columns.Add('Password',452)
$mainForm.Controls.Add($ListPwdHistory)

# Password history context menu
$contextMenu = [System.Windows.Forms.ContextMenuStrip]@{}
$menuItem1 = $contextMenu.Items.Add("Copy user name")
$menuItem1.Font = $pwdHistoryHeaderFont
$menuClick1 = {Set-Clipboard $ListPwdHistory.SelectedItems[0].SubItems[1].Text}
$menuItem1.add_Click($menuClick1)
$menuItem1.Image = $copyUserIconImage
$menuItem11 = $contextMenu.Items.Add("Copy password")
$menuItem11.Font = $pwdHistoryHeaderFont
$menuClick11 = {Set-Clipboard $ListPwdHistory.SelectedItems[0].SubItems[2].Text}
$menuItem11.add_Click($menuClick11)
$menuItem11.Image = $copyPasswordIconImage
[void]$contextMenu.Items.Add("-")
$menuItem12 = $contextMenu.Items.Add("Zoom preview")
$menuItem12.Font = $pwdHistoryHeaderFont
$menuClick12 = ({
    Set-MainWindowControlsDisabled
    $zoomDlgAccount.Text = $ListPwdHistory.SelectedItems[0].SubItems[1].Text;
    $zoomDlgPassword.Text = AddLineBreaksForPasswordPreview $ListPwdHistory.SelectedItems[0].SubItems[2].Text;
    $zoomDialog.ShowDialog($mainForm)
    Set-MainWindowControlsEnabled})
$menuItem12.add_Click($menuClick12)
$menuItem12.Image = $magnifyIconImage
[void]$contextMenu.Items.Add("-")
$menuItem2 = $contextMenu.Items.Add("Copy entry")
$menuItem2.Font = $pwdHistoryHeaderFont
$menuClick2 = {Set-Clipboard $($ListPwdHistory.SelectedItems[0].SubItems[0].Text + " " + $ListPwdHistory.SelectedItems[0].SubItems[1].Text + " " + $ListPwdHistory.SelectedItems[0].SubItems[2].Text)}
$menuItem2.add_Click($menuClick2)
$menuItem3 = $contextMenu.Items.Add("Copy all entries")
$menuItem3.Font = $pwdHistoryHeaderFont
$menuClick3 = {Set-Clipboard (GetAllListViewData)}
$menuItem3.add_Click($menuClick3)

$ListPwdHistory.Add_MouseClick({param($sender,$e)
    if ($e.Button -eq [System.Windows.Forms.MouseButtons]::Right){
        if ($ListPwdHistory.FocusedItem.GetBounds(
            [System.Windows.Forms.ItemBoundsPortion]::Entire).Contains($e.Location) -and
            ($ListPwdHistory.SelectedItems[0].SubItems[0].Text -ne "")){
            $contextMenu.Show([System.Windows.Forms.Cursor]::Position)
        }
    } 
})

function GetAllListViewData
{
    [string] $lvData = ""
    foreach ($item in $ListPwdHistory.Items)
    {
        $lvData += $item.SubItems[0].Text + " " + $item.SubItems[1].Text + " " + $item.SubItems[2].Text + "`n"
    }
    return $lvData
}
# -----

# ----- Area: Status bar ----------------------
$statusBar = New-Object System.Windows.Forms.StatusStrip
$statusBar.LayoutStyle = "HorizontalStackWithOverflow"
$statusBar.SizingGrip = $false
$statusBar.BackColor = "White"
$statusBar.ShowItemToolTips = $true
$mainForm.Controls.Add($statusBar)

$statusText = New-Object System.Windows.Forms.ToolStripStatusLabel
$statusText.Font = $statusBarFont
$statusText.ForeColor = "Blue"
$statusText.Padding = New-Object System.Windows.Forms.Padding(15,0,0,5);
$statusText.Text = "Tip: You can copy the history data using the context menu."
[void]$statusBar.Items.Add($statusText)

function Set-StatusText($Text, $AccessibleText="", [ValidateSet('Black', 'Blue', 'Green', 'Red')]$Color, $ToolTipText = "") {
    $statusText.Text = $Text
    $statusText.AccessibleName = if ([string]::IsNullOrWhiteSpace($AccessibleText)) {$Text} Else {$AccessibleText}
    $statusText.ForeColor = $Color
    # For tooltip: insert a line break on every space after a word or hyphen in a word if the line exceeds 70 characters.
    $statusText.ToolTipText = ($ToolTipText -replace '(.{70}.*?)(\s+(?!-)|(?<=-)\b+)',"`$1`n")
}

$helpText = New-Object System.Windows.Forms.ToolStripButton
$helpText.Font = $statusBarFont
$helpText.ForeColor = "Black"
$helpText.Alignment = "Right"
$helpText.Text = "?"
$helpText.ToolTipText = "Open online FAQ"
$helpText.AccessibleName = "Open online FAQ"
$helpText.AccessibleRole = 'Link'
$helpText.Add_Click({[system.Diagnostics.Process]::Start("https://github.com/htcfreek/SimpleLapsGui/#faq")})
[void]$statusBar.Items.Add($helpText)

$aboutText = New-Object System.Windows.Forms.ToolStripButton
$aboutText.Font = $statusBarFont
$aboutText.ForeColor = "Black"
$aboutText.Alignment = "Right"
$aboutText.Text = "Version: $scriptVersion"
$aboutText.ToolTipText = "About this tool"
$aboutText.AccessibleName = "About this tool"
$aboutText.Add_Click({$aboutForm.ShowDialog($mainForm)})
[void]$statusBar.Items.Add($aboutText)

#----- Area: Enable/disable ui controls ----------------------
function Set-MainWindowControlsDisabled {
    $compTextBox.Enabled = $False
    $goButton.Enabled = $False
    $AccountNameCopyButton.Enabled = $false;
    $AccountNamePreviewButton.Enabled = $false
    $PasswordCopyButton.Enabled = $false;
    $PasswordPreviewButton.Enabled = $false
    $TimeSetButton.Enabled = $false
    $ListPwdHistory.Enabled = $false
}

function Set-MainWindowControlsEnabled {
    $compTextBox.Enabled = $true;
    $GoButton.Enabled = $true;
    $AccountNameCopyButton.Enabled = $true;
    $AccountNamePreviewButton.Enabled = $true
    $PasswordCopyButton.Enabled = $true;
    $PasswordPreviewButton.Enabled = $true
    $TimeSetButton.Enabled = $true
    $ListPwdHistory.Enabled = $true
}

# ----- Area: Update window size ----------------------
# Update window size on different dpi scales
$dpiScale = [ProcessDPI]::GetDpiForWindow($mainForm.Handle)
if ($dpiScale -le 96) {
    # 100%
    $mainForm.Height = 400
}
elseif ($dpiScale -le 120) {
    # 125%
    $mainForm.Height = 410
}
elseif ($dpiScale -le 144) {
    # 150%
    $mainForm.Height = 420
}
elseif ($dpiScale -le 168) {
    # 175 %
    $mainForm.Height = 425
}
elseif ($dpiScale -le 192) {
    # 200 %
    $mainForm.Height = 430
}
elseif ($dpiScale -le 216) {
    # 225 %
    $mainForm.Height = 440
}
elseif ($dpiScale -le 240) {
    # 250 %
    $mainForm.Height = 450
}
else {
    # > 250%
    $mainForm.MaximizeBox = $true
    $mainForm.WindowState = [System.Windows.Forms.FormWindowState]::Maximized
}

# ----- Area: Show form ----------------------
$mainForm.ResumeLayout(); # Very important to correctly size and position all controls!
$mainForm.KeyPreview = $True
$mainForm.Add_KeyUp({if ($_.KeyCode -eq "Escape") {$mainForm.Close()}})
$mainForm.Add_Shown({ $this.Activate() })
$mainForm.Add_FormClosing({ $script:BgJobTimer.Stop() })
Show-Console -Hide;
[void]$mainForm.ShowDialog()

# Dispose objects after windows is closed
try {
    $RunspaceInstanceCache.PsInstance.EndInvoke($RunspaceInstanceCache.PsInvokationHandle)
    $psThreadInstance.Dispose()
    $runSpace.Close()
    $runSpace.Dispose()
}
catch {}
$mainForm.Dispose()
$contextMenu.Dispose()
$windowIconStream.Dispose()
$windowIconImage.Dispose()
$magnifyIconStream.Dispose()
$magnifyIconImage.Dispose()
$copyUserIconStream.Dispose()
$copyUserIconImage.Dispose()
$copyPasswordIconStream.Dispose()
$copyPasswordIconImage.Dispose()
$progressRunningGifStream.Dispose()
$progressRunningGifImage.Dispose()